import re
import math

# Common weak passwords list (can be expanded)
COMMON_PASSWORDS = [
    "password", "123456", "qwerty", "admin",
    "letmein", "welcome", "iloveyou"
]

def calculate_entropy(password):
    charset_size = 0

    if re.search(r"[a-z]", password):
        charset_size += 26
    if re.search(r"[A-Z]", password):
        charset_size += 26
    if re.search(r"[0-9]", password):
        charset_size += 10
    if re.search(r"[^a-zA-Z0-9]", password):
        charset_size += 32

    if charset_size == 0:
        return 0

    entropy = len(password) * math.log2(charset_size)
    return round(entropy, 2)

def check_strength(password):
    score = 0
    feedback = []

    if password.lower() in COMMON_PASSWORDS:
        return "Very Weak", ["Password is too common"]

    if len(password) >= 8:
        score += 1
    else:
        feedback.append("Use at least 8 characters")

    if re.search(r"[A-Z]", password):
        score += 1
    else:
        feedback.append("Add uppercase letters")

    if re.search(r"[a-z]", password):
        score += 1
    else:
        feedback.append("Add lowercase letters")

    if re.search(r"[0-9]", password):
        score += 1
    else:
        feedback.append("Add numbers")

    if re.search(r"[^a-zA-Z0-9]", password):
        score += 1
    else:
        feedback.append("Add special characters")

    if score <= 2:
        strength = "Weak"
    elif score <= 4:
        strength = "Moderate"
    else:
        strength = "Strong"

    return strength, feedback

def main():
    password = input("Enter password to check: ")

    strength, feedback = check_strength(password)
    entropy = calculate_entropy(password)

    print("\nPassword Strength:", strength)
    print("Entropy:", entropy, "bits")

    if feedback:
        print("Suggestions:")
        for tip in feedback:
            print("-", tip)
    else:
        print("Good password ðŸ‘")

if __name__ == "__main__":
    main()
